import{b as de,_ as Be,a as $e}from"./EditValue.vue_vue_type_script_setup_true_lang-Ccz30xne.js";import{f as D,bs as he,o as d,c as h,A as e,s as _,y as V,a as p,M as T,_ as Y,m as me,h as pe,v as f,ag as Z,ah as fe,af as Se,ae as Pe,O as _e,r as x,bt as ie,bu as re,n as A,w as ge,bv as R,ab as Ee,Q as ue,b as m,H as G,I as J,J as j,bw as Ie,aQ as ve,a7 as be,X as K,d as L,S as ee,V as Ce,a$ as Ue,bx as ce,by as Ne,p as Fe,a6 as ze,a8 as Re,bz as Te}from"./index-y-IgYf6E.js";import{a as Me,_ as Oe}from"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DnhMTKgS-BEjNSKcS.js";import{a as xe,_ as Ve}from"./BCard.vue_vue_type_script_setup_true_lang-DoeLCt4a-D7uvpCbJ.js";import{_ as Ae,a as ke,b as Ge}from"./ExchangeSelect.vue_vue_type_script_setup_true_lang-BrgJHb0V.js";import{_ as te}from"./BFormSelect.vue_vue_type_script_setup_true_lang-BigptVap-Dd8FLBDt.js";import{_ as ye}from"./chevron-down-D9NcD2_X.js";import"./plus-box-outline-D7lvavNO.js";var $=(c=>(c.string="string",c.number="number",c.boolean="boolean",c.option="option",c.list="list",c))($||{});const De={class:"copy-container position-relative"},Le={class:"text-start border p-1 mb-0"},He=D({__name:"CopyableTextfield",props:{content:{type:[String,Array],required:!0},isValid:{type:Boolean,default:!0}},setup(c){const{copy:o,isSupported:t}=he();return(n,v)=>{const g=de;return d(),h("div",De,[e(t)&&c.isValid?(d(),_(g,{key:0,role:"button",class:"copy-button position-absolute end-0 mt-1 me-2",onClick:v[0]||(v[0]=r=>e(o)(typeof c.content=="string"?c.content:JSON.stringify(c.content)))})):V("",!0),p("pre",Le,[p("code",null,T(c.content),1)])])}}}),Je=Y(He,[["__scopeId","data-v-d0e33a78"]]),je=D({__name:"PairlistConfigParameter",props:me({param:{}},{modelValue:{},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const o=pe(c,"modelValue");return(t,n)=>{const v=Z,g=fe,r=te,u=Ae,a=Se;return d(),_(a,{"label-cols":"4","label-size":"md",class:"pb-1 text-start",description:t.param.help},{label:f(()=>[p("label",null,T(t.param.description),1)]),default:f(()=>[t.param.type===e($).string||t.param.type===e($).number?(d(),_(v,{key:0,modelValue:o.value,"onUpdate:modelValue":n[0]||(n[0]=s=>o.value=s),size:"sm"},null,8,["modelValue"])):V("",!0),t.param.type===e($).boolean?(d(),_(g,{key:1,modelValue:o.value,"onUpdate:modelValue":n[1]||(n[1]=s=>o.value=s)},null,8,["modelValue"])):V("",!0),t.param.type===e($).option?(d(),_(r,{key:2,modelValue:o.value,"onUpdate:modelValue":n[2]||(n[2]=s=>o.value=s),options:t.param.options},null,8,["modelValue","options"])):V("",!0),t.param.type===e($).list?(d(),_(u,{key:3,modelValue:o.value,"onUpdate:modelValue":n[3]||(n[3]=s=>o.value=s)},null,8,["modelValue"])):V("",!0)]),_:1},8,["description"])}}}),q=Pe("pairlistConfig",()=>{var ne,ae,le,se;const c=_e(),o=x(!1),t=x(),n=x(((ne=c.activeBot)==null?void 0:ne.stakeCurrency)??"USDT"),v=x([]),g=x(!1),r=x({exchange:((ae=c.activeBot)==null?void 0:ae.botState.exchange)??"",trade_mode:{trading_mode:((le=c.activeBot)==null?void 0:le.botState.trading_mode)??ie.SPOT,margin_mode:((se=c.activeBot)==null?void 0:se.botState.trading_mode)===ie.FUTURES?re.ISOLATED:re.NONE}}),u=x(M()),a=x([]),s=x(""),S=A(()=>{var l;return!!((l=u.value.pairlists[0])!=null&&l.is_pairlist_generator)}),w=A(()=>S.value&&u.value.pairlists.length>0),I=A(()=>JSON.stringify(oe(),null,2)),U=l=>a.value.findIndex(i=>i.name===l)>-1;function N(l,i){l=structuredClone(R(l)),l.showParameters=!1,l.id||(l.id=Date.now().toString(36)+Math.random().toString(36).substring(2));for(const C in l.params)l.params[C].value=Ee(l.params[C].default)?l.params[C].default:"";u.value.pairlists.splice(i,0,l)}function y(l){u.value.pairlists.splice(l,1)}function B(l=""){const i=a.value.findIndex(C=>C.name===u.value.name);u.value.name=l,i>-1?a.value[i]=structuredClone(R(u.value)):a.value.push(structuredClone(R(u.value)))}function P(l){const i=M({name:l});a.value.push(i),u.value=structuredClone(i)}function k(l=""){const i=M({name:l,pairlists:R(u.value.pairlists),blacklist:R(u.value.blacklist)});a.value.push(i),u.value=structuredClone(i)}function E(){const l=a.value.findIndex(i=>i.name===u.value.name);l>-1&&(a.value.splice(l,1),F(a.value.length>0?a.value[0].name:"default"))}function F(l){const i=a.value.find(C=>l===C.name);i?u.value=structuredClone(R(i)):P(l)}function M({name:l="",pairlists:i=[],blacklist:C=[]}={}){return{name:l,pairlists:i,blacklist:C}}function Q(){u.value.blacklist.push("")}function H(l){u.value.blacklist.splice(l,1)}function b(l){const i=a.value.find(C=>C.name===l);i&&(u.value.blacklist=structuredClone(R(i.blacklist)))}async function O(){const l=we();o.value=!0;try{const{job_id:i}=await c.activeBot.evaluatePairlist(l);console.log("jobId",i),t.value=window.setInterval(async()=>{if(!(await c.activeBot.getBackgroundJobStatus(i)).running){clearInterval(t.value);const z=await c.activeBot.getPairlistEvalResult(i);o.value=!1,z.status==="success"?v.value=z.result.whitelist:z.error&&(ue(z.error,"danger"),o.value=!1)}},1e3)}catch{ue("Evaluation failed","danger"),o.value=!1}}function W(l,i){return l===$.number?Number(i):l===$.boolean?!!i:l===$.list?i:String(i)}function we(){const i={pairlists:oe(),stake_currency:n.value,blacklist:u.value.blacklist};return g.value&&(console.log("setting custom exchange props"),i.exchange=r.value.exchange,i.trading_mode=r.value.trade_mode.trading_mode,i.margin_mode=r.value.trade_mode.margin_mode),i}function oe(){const l=[];return u.value.pairlists.forEach(i=>{const C={method:i.name};for(const z in i.params){const X=i.params[z];X.value&&(C[z]=W(X.type,X.value))}l.push(C)}),l}return ge(()=>u.value,()=>{s.value=u.value.name},{deep:!0}),{evaluating:o,whitelist:v,config:u,configJSON:I,savedConfigs:a,configName:s,startPairlistEvaluation:O,addToConfig:N,removeFromConfig:y,saveConfig:B,duplicateConfig:k,deleteConfig:E,newConfig:P,selectOrCreateConfig:F,addToBlacklist:Q,removeFromBlacklist:H,duplicateBlacklist:b,isSavedConfig:U,firstPairlistIsGenerator:S,pairlistValid:w,stakeCurrency:n,customExchange:g,selectedExchange:r}},{persist:{key:"ftPairlistConfig",pick:["savedConfigs","configName"]}}),qe={class:"d-flex text-start align-items-center"},Qe={class:"d-flex flex-grow-1 align-items-center"},We={class:"fw-bold"},Xe={class:"text-small"},Ke=D({__name:"PairlistConfigItem",props:me({index:{}},{modelValue:{required:!0},modelModifiers:{}}),emits:["update:modelValue"],setup(c){const o=q(),t=pe(c,"modelValue"),n=A(()=>Object.keys(t.value.params).length>0);function v(){n.value&&(t.value.showParameters=!t.value.showParameters)}return(g,r)=>{const u=Ie,a=ve,s=ye,S=ke,w=je,I=xe,U=be,N=Ve;return d(),_(N,{"no-body":"",class:"mb-2"},{header:f(()=>[p("div",qe,[p("div",Qe,[m(u,{role:"button",class:"handle me-2 fs-4 flex-shrink-0",width:"24",height:"24"}),p("div",{role:"button",class:"d-flex flex-grow-1 align-items-start flex-column user-select-none",onClick:v},[p("span",We,T(t.value.name),1),p("span",Xe,T(t.value.description),1)])]),m(a,{role:"button",width:"24",height:"24",class:"mx-2",onClick:r[0]||(r[0]=y=>e(o).removeFromConfig(g.index))}),t.value.showParameters?V("",!0):(d(),_(s,{key:0,class:G([e(n)&&!t.value.showParameters?"visible":"invisible","fs-4"]),role:"button",onClick:v},null,8,["class"])),t.value.showParameters?(d(),_(S,{key:1,class:G([e(n)&&t.value.showParameters?"visible":"invisible","fs-4"]),role:"button",onClick:v},null,8,["class"])):V("",!0)])]),default:f(()=>[m(U,{modelValue:t.value.showParameters,"onUpdate:modelValue":r[1]||(r[1]=y=>t.value.showParameters=y)},{default:f(()=>[m(I,null,{default:f(()=>[(d(!0),h(J,null,j(t.value.params,(y,B)=>(d(),_(w,{key:B,modelValue:t.value.params[B].value,"onUpdate:modelValue":P=>t.value.params[B].value=P,param:y},null,8,["modelValue","onUpdate:modelValue","param"]))),128))]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),Ye={class:"d-flex mb-4 align-items-center gap-2"},Ze=D({__name:"PairlistConfigBlacklist",setup(c){const o=q(),t=x(""),n=x(!1),v=A(()=>o.savedConfigs.filter(g=>g.name!==o.config.name).map(g=>g.name));return(g,r)=>{const u=ye,a=ke,s=te,S=de,w=ee,I=Z,U=ve,N=Be,y=xe,B=be,P=Ve;return d(),_(P,{"no-body":"",class:"mb-2"},{header:f(()=>[p("div",{class:"d-flex flex-row align-items-center justify-content-between",role:"button",onClick:r[0]||(r[0]=k=>n.value=!e(n))},[r[5]||(r[5]=p("span",{class:"fw-bold fd-italic"},"Blacklist",-1)),e(n)?V("",!0):(d(),_(u,{key:0,class:G([e(n)?"invisible":"visible","fs-4"]),role:"button"},null,8,["class"])),e(n)?(d(),_(a,{key:1,class:G([e(n)?"visible":"invisible","fs-4"]),role:"button"},null,8,["class"])):V("",!0)])]),default:f(()=>[m(B,{modelValue:e(n),"onUpdate:modelValue":r[4]||(r[4]=k=>K(n)?n.value=k:null)},{default:f(()=>[m(y,null,{default:f(()=>[p("div",Ye,[r[6]||(r[6]=p("span",{class:"col-auto"},"Copy from:",-1)),m(s,{modelValue:e(t),"onUpdate:modelValue":r[1]||(r[1]=k=>K(t)?t.value=k:null),size:"sm",options:e(v)},null,8,["modelValue","options"]),m(w,{title:"Copy",size:"sm",onClick:r[2]||(r[2]=k=>e(o).duplicateBlacklist(e(t)))},{default:f(()=>[m(S)]),_:1})]),(d(!0),h(J,null,j(e(o).config.blacklist,(k,E)=>(d(),_(N,{key:E,class:"mb-2",size:"sm"},{append:f(()=>[m(w,{size:"sm",onClick:F=>e(o).removeFromBlacklist(E)},{default:f(()=>[m(U)]),_:2},1032,["onClick"])]),default:f(()=>[m(I,{modelValue:e(o).config.blacklist[E],"onUpdate:modelValue":F=>e(o).config.blacklist[E]=F},null,8,["modelValue","onUpdate:modelValue"])]),_:2},1024))),128)),m(w,{size:"sm",onClick:r[3]||(r[3]=k=>e(o).addToBlacklist())},{default:f(()=>r[7]||(r[7]=[L("Add")])),_:1})]),_:1})]),_:1},8,["modelValue"])]),_:1})}}}),et={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function tt(c,o){return d(),h("svg",et,o[0]||(o[0]=[p("path",{fill:"currentColor",d:"M15 9H5V5h10m-3 14a3 3 0 0 1-3-3a3 3 0 0 1 3-3a3 3 0 0 1 3 3a3 3 0 0 1-3 3m5-16H5a2 2 0 0 0-2 2v14a2 2 0 0 0 2 2h14a2 2 0 0 0 2-2V7z"},null,-1)]))}const ot=Ce({name:"mdi-content-save",render:tt}),nt={class:"d-flex flex-column flex-sm-row mb-2 gap-2"},at=D({__name:"PairlistConfigActions",setup(c){const o=q();return(t,n)=>{const v=ot,g=ee,r=te,u=Ue;return d(),h("div",nt,[m(g,{title:"Save configuration",size:"sm",variant:"primary",onClick:n[0]||(n[0]=a=>e(o).saveConfig(e(o).config.name))},{default:f(()=>[m(v)]),_:1}),m($e,{modelValue:e(o).config.name,"onUpdate:modelValue":n[3]||(n[3]=a=>e(o).config.name=a),"editable-name":"config","allow-add":!0,"allow-duplicate":!0,"allow-edit":!0,class:"d-flex flex-grow-1",onDelete:e(o).deleteConfig,onDuplicate:n[4]||(n[4]=(a,s)=>e(o).duplicateConfig(s)),onNew:n[5]||(n[5]=a=>e(o).newConfig(a)),onRename:n[6]||(n[6]=(a,s)=>e(o).saveConfig(s))},{default:f(()=>[m(r,{modelValue:e(o).configName,"onUpdate:modelValue":[n[1]||(n[1]=a=>e(o).configName=a),n[2]||(n[2]=a=>e(o).selectOrCreateConfig(a))],size:"sm",options:e(o).savedConfigs.map(a=>a.name)},null,8,["modelValue","options"])]),_:1},8,["modelValue","onDelete"]),m(g,{title:"Evaluate pairlist",disabled:e(o).evaluating||!e(o).pairlistValid,variant:"primary",class:"px-5",size:"sm",onClick:n[7]||(n[7]=a=>e(o).startPairlistEvaluation())},{default:f(()=>[e(o).evaluating?(d(),_(u,{key:0,small:""})):V("",!0),p("span",null,T(e(o).evaluating?"":"Evaluate"),1)]),_:1},8,["disabled"])])}}}),lt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function st(c,o){return d(),h("svg",lt,o[0]||(o[0]=[p("path",{fill:"currentColor",d:"m17 12l-5 5v-3H8v-4h4V7zM3 19V5a2 2 0 0 1 2-2h14a2 2 0 0 1 2 2v14a2 2 0 0 1-2 2H5a2 2 0 0 1-2-2m2 0h14V5H5z"},null,-1)]))}const it=Ce({name:"mdi-arrow-right-bold-box-outline",render:st}),rt={class:"d-flex px-3 mb-3 gap-3 flex-column flex-lg-row"},ut={class:"d-flex flex-grow-1 align-items-start flex-column"},ct={class:"fw-bold"},dt={class:"text-small"},mt={class:"d-flex flex-column flex-fill"},pt={class:"border rounded-1 p-2 mb-2"},ft={class:"d-flex align-items-center gap-2 my-2"},_t={class:"mb-2 border rounded-1 p-2 text-start"},gt={class:"d-flex flex-column col-12 col-lg-3"},vt={class:"position-relative flex-fill overflow-auto"},bt=D({__name:"PairlistConfigurator",setup(c){const o=_e(),t=q(),n=x([]),v=x(null),g=x(null),r=x("Config"),u=A(()=>t.config.pairlists.length==0);return ce(g,n.value,{group:{name:"configurator",pull:"clone",put:!1},sort:!1,filter:".no-drag",dragClass:"dragging"}),ce(v,t.config.pairlists,{handle:".handle",group:"configurator",onUpdate:async a=>{Ne(t.config.pairlists,a.oldIndex,a.newIndex)},onAdd:a=>{const s=n.value[a.oldIndex];t.addToConfig(s,a.newIndex),a.clone.replaceWith(a.item),a.clone.remove()}}),Fe(async()=>{n.value=(await o.activeBot.getPairlists()).pairlists.sort((a,s)=>a.is_pairlist_generator===s.is_pairlist_generator?a.name.localeCompare(s.name):a.is_pairlist_generator?-1:1),t.selectOrCreateConfig(t.isSavedConfig(t.configName)?t.configName:"default")}),ge(()=>t.whitelist,()=>{r.value="Results"}),(a,s)=>{const S=it,w=ee,I=ze,U=Re,N=at,y=Z,B=fe,P=Ge,k=Ze,E=Te,F=Ke,M=Me,Q=Oe,H=Je;return d(),h("div",rt,[m(U,{ref_key:"availablePairlistsEl",ref:g,class:"available-pairlists"},{default:f(()=>[(d(!0),h(J,null,j(e(n),b=>(d(),_(I,{key:b.name,class:G([{"no-drag":e(t).config.pairlists.length==0&&!b.is_pairlist_generator},"pairlist d-flex text-start align-items-center py-2 px-3"])},{default:f(()=>[p("div",ut,[p("span",ct,T(b.name),1),p("span",dt,T(b.description),1)]),m(w,{class:"p-0 add-pairlist",style:{border:"none"},variant:"outline-light",disabled:e(t).config.pairlists.length==0&&!b.is_pairlist_generator,onClick:O=>e(t).addToConfig(b,e(t).config.pairlists.length)},{default:f(()=>[m(S,{class:"fs-4"})]),_:2},1032,["disabled","onClick"])]),_:2},1032,["class"]))),128))]),_:1},512),p("div",mt,[m(N),p("div",pt,[p("div",ft,[s[4]||(s[4]=p("span",{class:"col-auto"},"Stake currency: ",-1)),m(y,{modelValue:e(t).stakeCurrency,"onUpdate:modelValue":s[0]||(s[0]=b=>e(t).stakeCurrency=b),size:"sm"},null,8,["modelValue"])]),p("div",_t,[m(B,{modelValue:e(t).customExchange,"onUpdate:modelValue":s[1]||(s[1]=b=>e(t).customExchange=b),class:"mb-2"},{default:f(()=>s[5]||(s[5]=[L(" Custom Exchange ")])),_:1},8,["modelValue"]),e(t).customExchange?(d(),_(P,{key:0,modelValue:e(t).selectedExchange,"onUpdate:modelValue":s[2]||(s[2]=b=>e(t).selectedExchange=b)},null,8,["modelValue"])):V("",!0)])]),m(k),m(E,{"model-value":e(t).config.pairlists.length>0&&!e(t).firstPairlistIsGenerator,variant:"warning"},{default:f(()=>s[6]||(s[6]=[L(" First entry in the pairlist must be a Generating pairlist, like StaticPairList or VolumePairList. ")])),_:1},8,["model-value"]),p("div",{ref_key:"pairlistConfigsEl",ref:v,class:G(["d-flex flex-column flex-grow-1 position-relative border rounded-1 p-1",{empty:e(u)}])},[(d(!0),h(J,null,j(e(t).config.pairlists,(b,O)=>(d(),_(F,{key:b.id,modelValue:e(t).config.pairlists[O],"onUpdate:modelValue":W=>e(t).config.pairlists[O]=W,index:O,onRemove:e(t).removeFromConfig},null,8,["modelValue","onUpdate:modelValue","index","onRemove"]))),128))],2)]),p("div",gt,[m(Q,{modelValue:e(r),"onUpdate:modelValue":s[3]||(s[3]=b=>K(r)?r.value=b:null),class:"mb-2",size:"sm",buttons:""},{default:f(()=>[m(M,{button:"",value:"Config"},{default:f(()=>s[7]||(s[7]=[L(" Config")])),_:1}),m(M,{button:"",value:"Results",disabled:e(t).whitelist.length===0},{default:f(()=>s[8]||(s[8]=[L(" Results")])),_:1},8,["disabled"])]),_:1},8,["modelValue"]),p("div",vt,[e(r)==="Config"?(d(),_(H,{key:0,class:"position-lg-absolute w-100",content:e(t).configJSON,"is-valid":e(t).pairlistValid},null,8,["content","is-valid"])):V("",!0),e(r)==="Results"?(d(),_(H,{key:1,class:"position-lg-absolute w-100",content:e(t).whitelist},null,8,["content"])):V("",!0)])])])}}}),Ct=Y(bt,[["__scopeId","data-v-77d56e16"]]),xt={};function Vt(c,o){const t=Ct;return d(),_(t,{class:"pt-4"})}const Et=Y(xt,[["render",Vt]]);export{Et as default};
//# sourceMappingURL=PairlistConfigView-CzWgfIzV.js.map
