import{bK as j,bL as q,bM as Q,bN as W,V as Y,o as r,c as x,a as l,f as X,bO as Z,b as p,v as g,I as z,J,A as m,s as h,M as E,y as O,d as w,ar as ee,bP as te,a6 as se,a8 as ne,T as oe,S as G,r as k,n as ae,O as le,bu as ie,bt as re,X as H,as as R,ah as de,ag as ce,bz as ue,a7 as me,_ as _e}from"./index-y-IgYf6E.js";import{_ as pe}from"./BCard.vue_vue_type_script_setup_true_lang-DoeLCt4a-D7uvpCbJ.js";import{_ as fe,a as ge,b as ve}from"./ExchangeSelect.vue_vue_type_script_setup_true_lang-BrgJHb0V.js";import{_ as xe}from"./chevron-down-D9NcD2_X.js";import{_ as he}from"./TimeRangeSelect.vue_vue_type_script_setup_true_lang-B8SFseJR.js";import"./plus-box-outline-D7lvavNO.js";import"./BFormSelect.vue_vue_type_script_setup_true_lang-BigptVap-Dd8FLBDt.js";function we(t,s){var n,a;return(s.ctx===t.instance.$?(n=ke(s,t.instance.$))==null?void 0:n.provides:(a=s.ctx)==null?void 0:a.provides)??t.instance.$.provides}function ke(t,s){const n=new Set,a=v=>{var _,d;for(const i of v){if(!i)continue;if(i===t||i.el&&t.el&&i.el===t.el)return!0;n.add(i);let f;if(i.suspense?f=a([i.ssContent]):Array.isArray(i.children)?f=a(i.children):(_=i.component)!=null&&_.vnode&&(f=a([(d=i.component)==null?void 0:d.subTree])),f)return f;n.delete(i)}return!1};if(!a([s.subTree]))return console.error("Could not find original vnode,  will not inherit provides"),s;const o=Array.from(n).reverse();for(const v of o)if(v.component)return v.component;return s}const be=(t,s)=>{const{modifiers:n,arg:a,value:o}=t,v=Object.keys(n||{}),_=typeof o=="string"?o.split(j):o;if(s.tagName.toLowerCase()==="a"){const d=s.getAttribute("href")||"";q.test(d)&&v.push(d.replace(Q,""))}return Array.prototype.concat.apply([],[a,_]).forEach(d=>typeof d=="string"&&v.push(d)),v.filter((d,i,f)=>d&&f.indexOf(d)===i)},I=(t,s,n,a)=>{var o;const _=(o=we(n,a)[W])==null?void 0:o.map;t.forEach(d=>{if(_!=null&&_[d]){_[d].toggle();return}const i=document.getElementById(d);i!==null&&i.dispatchEvent(new Event("bv-toggle"))}),setTimeout(()=>K(t,s),50)},K=(t,s)=>{let n=!1;t.forEach(a=>{const o=document.getElementById(a);o!=null&&o.classList.contains("show")&&(n=!0),o!=null&&o.classList.contains("closing")&&(n=!1)}),s.setAttribute("aria-expanded",n?"true":"false"),s.classList.remove(n?"collapsed":"not-collapsed"),s.classList.add(n?"not-collapsed":"collapsed")},F=(t,s,n)=>{const a=be(s,t);a.length!==0&&(t.__toggle?setTimeout(()=>{t.removeEventListener("click",t.__toggle),t.__toggle=()=>I(a,t,s,n),t.addEventListener("click",t.__toggle)},0):(t.__toggle=()=>I(a,t,s,n),t.addEventListener("click",t.__toggle)),t.setAttribute("aria-controls",a.join(" ")),K(a,t))},ye={mounted:F,updated:F,unmounted(t){t.removeEventListener("click",t.__toggle),t.removeAttribute("aria-controls"),t.removeAttribute("aria-expanded")}},Ve={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Se(t,s){return r(),x("svg",Ve,s[0]||(s[0]=[l("path",{fill:"currentColor",d:"M8 17v-2h8v2zm8-7l-4 4l-4-4h2.5V7h3v3zM5 3h14a2 2 0 0 1 2 2v14c0 1.11-.89 2-2 2H5a2 2 0 0 1-2-2V5c0-1.1.9-2 2-2m0 2v14h14V5z"},null,-1)]))}const Te=Y({name:"mdi-download-box-outline",render:Se}),Ee={class:"d-flex flex-row align-items-end gap-1"},Be={key:1},Ce={class:"d-flex justify-content-between"},$e={key:1},De={key:2,class:"w-25"},Ae={key:3,class:"d-flex flex-column w-100 flex-grow gap-2"},Ue=X({__name:"BackgroundJobTracking",setup(t){const{runningJobs:s,clearJobs:n}=Z();return(a,o)=>{const v=Te,_=ee,d=te,i=se,f=ne,M=oe,N=G;return r(),x("div",Ee,[p(f,{class:"ms-2 w-100 flex-grow"},{default:g(()=>[(r(!0),x(z,null,J(m(s),(c,e)=>(r(),h(i,{key:e,class:"d-flex gap-2 align-items-center",title:e},{default:g(()=>{var B,V,y,b,C,$,D,A,U,L;return[((B=c.taskStatus)==null?void 0:B.job_category)==="download_data"?(r(),h(v,{key:0})):(r(),x("span",Be,E((V=c.taskStatus)==null?void 0:V.job_category),1)),l("div",Ce,[((y=c.taskStatus)==null?void 0:y.status)==="success"?(r(),h(_,{key:0,class:"text-success",title:""})):(r(),x("span",$e,E((b=c.taskStatus)==null?void 0:b.status),1)),(C=c.taskStatus)!=null&&C.progress?(r(),x("span",De,E(($=c.taskStatus)==null?void 0:$.progress),1)):O("",!0)]),(D=c.taskStatus)!=null&&D.progress?(r(),h(d,{key:2,class:"w-100 flex-grow",value:(A=c.taskStatus)==null?void 0:A.progress,"show-progress":"",max:100,striped:""},null,8,["value"])):O("",!0),(U=c.taskStatus)!=null&&U.progress_tasks?(r(),x("div",Ae,[(r(!0),x(z,null,J(Object.entries((L=c.taskStatus)==null?void 0:L.progress_tasks),([P,S])=>{var T;return r(),x("div",{key:P,class:"w-100"},[w(E(S.description)+" ",1),p(d,{class:"w-100 flex-grow",value:S.progress,"show-progress":"",variant:((T=c.taskStatus)==null?void 0:T.status)==="success"?"success":"primary",max:S.total,striped:""},null,8,["value","variant","max"])])}),128))])):O("",!0)]}),_:2},1032,["title"]))),128))]),_:1}),Object.keys(m(s)).length>0?(r(),h(N,{key:0,size:"sm",class:"ms-auto",onClick:m(n)},{default:g(()=>[p(M)]),_:1},8,["onClick"])):O("",!0)])}}}),Le=k([{description:"All USDT Pairs",pairs:[".*/USDT"]},{description:"All USDT Futures Pairs",pairs:[".*/USDT:USDT"]}]);function Pe(){return{pairTemplates:ae(()=>Le.value.map((t,s)=>({...t,idx:s})))}}const Oe={class:"container-md px-1"},He={class:"d-flex mb-3 gap-3 flex-column"},Me={class:"d-flex flex-column gap-3"},Ne={class:"d-flex flex-column flex-lg-row gap-3"},ze={class:"flex-fill"},Je={class:"d-flex flex-column gap-2"},Re={class:"d-flex gap-2"},Ie={class:"d-flex flex-column gap-1"},Fe={class:"d-flex flex-column gap-1"},Xe={class:"flex-fill px-3"},Ge={class:"d-flex flex-column gap-2"},Ke={class:"px-3 border border p-2 rounded-1"},je={class:"d-flex flex-column gap-2"},qe={class:"d-flex justify-content-between align-items-center"},Qe={key:0},We={key:1,class:"d-flex align-items-center gap-2"},Ye={class:"mb-2 border rounded-1 p-2 text-start"},Ze={class:"mb-2 border rounded-1 p-2 text-start"},et={class:"mb-2 border rounded-1 p-2 text-start"},tt={class:"px-3"},st=X({__name:"DownloadDataMain",setup(t){const s=le(),n=k(["BTC/USDT","ETH/USDT",""]),a=k(["5m","1h"]),o=k({useCustomTimerange:!1,timerange:"",days:30}),{pairTemplates:v}=Pe(),_=k({customExchange:!1,selectedExchange:{exchange:"binance",trade_mode:{margin_mode:ie.NONE,trading_mode:re.SPOT}}}),d=k(!1),i=k(!1),f=k(!1);function M(c){n.value.push(...c)}async function N(){const c={pairs:n.value.filter(e=>e!==""),timeframes:a.value.filter(e=>e!=="")};o.value.useCustomTimerange&&o.value.timerange?c.timerange=o.value.timerange:c.days=o.value.days,f.value&&(c.erase=d.value,c.download_trades=i.value,_.value.customExchange&&(c.exchange=_.value.selectedExchange.exchange,c.trading_mode=_.value.selectedExchange.trade_mode.trading_mode,c.margin_mode=_.value.selectedExchange.trade_mode.margin_mode)),await s.activeBot.startDataDownload(c)}return(c,e)=>{const B=Ue,V=fe,y=G,b=de,C=he,$=ce,D=xe,A=ge,U=ue,L=ve,P=me,S=pe,T=ye;return r(),x("div",Oe,[p(B,{class:"mb-4"}),p(S,{header:"Downloading Data",class:"px-0 mx-1"},{default:g(()=>[l("div",He,[l("div",Me,[l("div",Ne,[l("div",ze,[l("div",Je,[e[10]||(e[10]=l("div",{class:"d-flex justify-content-between"},[l("h4",{class:"text-start"},"Select Pairs"),l("h5",{class:"text-start"},"Pairs from template")],-1)),l("div",Re,[p(V,{modelValue:m(n),"onUpdate:modelValue":e[0]||(e[0]=u=>H(n)?n.value=u:null),placeholder:"Pair",size:"md",class:"flex-grow-1"},null,8,["modelValue"]),l("div",Ie,[l("div",Fe,[(r(!0),x(z,null,J(m(v),u=>(r(),h(y,{key:u.idx,variant:"secondary",title:u.pairs,onClick:at=>M(u.pairs)},{default:g(()=>[w(E(u.description),1)]),_:2},1032,["title","onClick"]))),128))])])])])]),l("div",Xe,[l("div",Ge,[e[11]||(e[11]=l("h4",{class:"text-start"},"Select timeframes",-1)),p(V,{modelValue:m(a),"onUpdate:modelValue":e[1]||(e[1]=u=>H(a)?a.value=u:null),placeholder:"Timeframe",size:"md"},null,8,["modelValue"])])])]),l("div",Ke,[l("div",je,[l("div",qe,[e[13]||(e[13]=l("h4",{class:"text-start mb-0"},"Time Selection",-1)),p(b,{modelValue:m(o).useCustomTimerange,"onUpdate:modelValue":e[2]||(e[2]=u=>m(o).useCustomTimerange=u),class:"mb-0",switch:""},{default:g(()=>e[12]||(e[12]=[w(" Use custom timerange ")])),_:1},8,["modelValue"])]),m(o).useCustomTimerange?(r(),x("div",Qe,[p(C,{modelValue:m(o).timerange,"onUpdate:modelValue":e[3]||(e[3]=u=>m(o).timerange=u)},null,8,["modelValue"])])):(r(),x("div",We,[e[14]||(e[14]=l("label",null,"Days to download:",-1)),p($,{modelValue:m(o).days,"onUpdate:modelValue":e[4]||(e[4]=u=>m(o).days=u),type:"number","aria-label":"Days to download",min:"1",style:{width:"100px"}},null,8,["modelValue"])]))])]),l("div",Ye,[R((r(),h(y,{class:"mb-2",onClick:e[5]||(e[5]=u=>f.value=!m(f))},{default:g(()=>[e[15]||(e[15]=w(" Advanced Options ")),m(f)?(r(),h(A,{key:1})):(r(),h(D,{key:0}))]),_:1})),[[T,void 0,void 0,{"advanced-options":!0}]]),p(P,{id:"advanced-options"},{default:g(()=>[p(U,{variant:"info","model-value":!0,class:"mb-2"},{default:g(()=>e[16]||(e[16]=[w(" Advanced options (Erase data, Download trades, and Custom Exchange settings) will only be applied when this section is expanded. ")])),_:1}),l("div",Ze,[p(b,{modelValue:m(d),"onUpdate:modelValue":e[6]||(e[6]=u=>H(d)?d.value=u:null),class:"mb-2"},{default:g(()=>e[17]||(e[17]=[w("Erase existing data")])),_:1},8,["modelValue"]),p(b,{modelValue:m(i),"onUpdate:modelValue":e[7]||(e[7]=u=>H(i)?i.value=u:null),class:"mb-2"},{default:g(()=>e[18]||(e[18]=[w(" Download Trades instead of OHLCV data ")])),_:1},8,["modelValue"])]),l("div",et,[R((r(),h(b,{modelValue:m(_).customExchange,"onUpdate:modelValue":e[8]||(e[8]=u=>m(_).customExchange=u),class:"mb-2"},{default:g(()=>e[19]||(e[19]=[w(" Custom Exchange ")])),_:1},8,["modelValue"])),[[T,void 0,void 0,{"custom-exchange":!0}]]),p(P,{id:"custom-exchange"},{default:g(()=>[p(L,{modelValue:m(_).selectedExchange,"onUpdate:modelValue":e[9]||(e[9]=u=>m(_).selectedExchange=u)},null,8,["modelValue"])]),_:1})])]),_:1})]),l("div",tt,[p(y,{variant:"primary",onClick:N},{default:g(()=>e[20]||(e[20]=[w("Start Download")])),_:1})])])])]),_:1})])}}}),nt={};function ot(t,s){const n=st;return r(),h(n,{class:"pt-4"})}const _t=_e(nt,[["render",ot]]);export{_t as default};
//# sourceMappingURL=DownloadDataView-C4WezKlh.js.map
