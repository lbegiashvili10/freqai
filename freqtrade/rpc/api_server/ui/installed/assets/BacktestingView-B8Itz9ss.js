import{V as F,o as r,c as b,a as d,f as S,O as H,r as A,n as M,w as ae,b as l,A as t,X as U,v as c,d as w,M as R,I as P,J as K,s as g,y as p,a6 as de,S as N,a7 as Re,a8 as me,_ as O,a9 as se,a0 as Ce,aa as Te,Z as T,W as oe,ab as Ve,ac as ne,P as Z,ad as Se,U as J,h as Ae,p as ie,R as ue,ae as qe,af as _e,ag as fe,ah as Me,ai as Le,aj as ce,H as pe,L as W,ak as Pe,al as Ue,am as De,an as Ie,T as ke,ao as ze,ap as Fe,aq as He,ar as Ne,as as Ee,at as Oe,au as je}from"./index-y-IgYf6E.js";import{_ as Q}from"./BCard.vue_vue_type_script_setup_true_lang-DoeLCt4a-D7uvpCbJ.js";import{c as be}from"./TradeList-DRyRW5ZY.js";import{_ as Ge}from"./chevron-down-D9NcD2_X.js";import{_ as We,a as Ke,b as Ze,c as ge}from"./InfoBox.vue_vue_type_script_setup_true_lang-DuHi0co2.js";import{_ as ye,a as Je}from"./BFormRadioGroup.vue_vue_type_script_setup_true_lang-DnhMTKgS-BEjNSKcS.js";import{_ as Qe,a as Xe}from"./CandleChartContainer-2ogjemzQ.js";import{a as Ye,_ as et}from"./MessageBox.vue_vue_type_script_setup_true_lang-bL12gaFm.js";import{_ as tt,a as at,b as st}from"./TradesLogChart-BugI9k-Y.js";import{u as nt,i as lt,a as ot,b as it,c as rt,d as ct,E as dt}from"./installCanvasRenderer-BpNB3XR3.js";import{i as mt,a as ut,b as _t,c as ft,d as pt,e as kt,f as bt}from"./chartZoom-B-0dVpED.js";import{_ as gt}from"./TimeRangeSelect.vue_vue_type_script_setup_true_lang-B8SFseJR.js";import{_ as yt}from"./BFormSelect.vue_vue_type_script_setup_true_lang-BigptVap-Dd8FLBDt.js";import{_ as vt,a as ht}from"./StrategySelect.vue_vue_type_script_setup_true_lang-Cb6_4NaJ.js";import"./event-a_bi5ysw-CCMJ8JbX.js";import"./EditValue.vue_vue_type_script_setup_true_lang-Ccz30xne.js";import"./plus-box-outline-D7lvavNO.js";const xt={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Bt(e,a){return r(),b("svg",xt,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M8.59 16.58L13.17 12L8.59 7.41L10 6l6 6l-6 6z"},null,-1)]))}const re=F({name:"mdi-chevron-right",render:Bt}),$t={class:"d-flex justify-content-center"},wt={class:"d-flex"},Rt={class:"d-flex flex-column"},Ct={key:0},Tt={class:"px-3 m-0"},Vt=S({__name:"TradeListNav",props:{trades:{required:!0,type:Array},backtestMode:{required:!1,default:!1,type:Boolean}},emits:["trade-select"],setup(e,{emit:a}){const n=e,_=a,m=H(),s=A({}),i=A(!0),o=A("openDate"),f=[{text:"Open date",value:"openDate"},{text:"Profit %",value:"profit"}],v=$=>{s.value=$,_("trade-select",$)},x=M(()=>{const $=o.value==="profit"?"profit_ratio":"open_timestamp";return i.value?n.trades.slice().sort((h,C)=>C[$]-h[$]):n.trades.slice().sort((h,C)=>h[$]-C[$])}),u=A(x.value.map(()=>!1));return ae(()=>m.activeBot.selectedPair,()=>{u.value=x.value.map(()=>!1)}),($,h)=>{const C=ye,B=de,k=We,L=Ke,j=Ze,G=re,y=Ge,E=N,X=Re,Y=me;return r(),b("div",null,[d("div",$t,[h[2]||(h[2]=d("span",{class:"me-2"},"Sort by:",-1)),l(C,{modelValue:t(o),"onUpdate:modelValue":h[0]||(h[0]=V=>U(o)?o.value=V:null),options:f,name:"radio-options"},null,8,["modelValue"])]),l(Y,null,{default:c(()=>[l(B,{button:"",class:"d-flex flex-wrap justify-content-center align-items-center",title:"Trade Navigation",onClick:h[1]||(h[1]=V=>i.value=!t(i))},{default:c(()=>[w("Trade Navigation "+R(t(i)?"↓":"↑"),1)]),_:1}),(r(!0),b(P,null,K(t(x),(V,D)=>(r(),g(B,{key:V.open_timestamp,button:"",class:"d-flex flex-column py-1 pe-1 align-items-stretch",title:`${V.pair}`,active:V.open_timestamp===t(s).open_timestamp,onClick:I=>v(V)},{default:c(()=>[d("div",wt,[d("div",Rt,[d("div",null,[t(m).activeBot.botState.trading_mode!=="spot"?(r(),b("span",Ct,R(V.is_short?"S-":"L-"),1)):p("",!0),l(k,{date:V.open_timestamp},null,8,["date"])]),l(L,{trade:V,class:"my-1"},null,8,["trade"]),e.backtestMode?(r(),g(j,{key:0,"profit-ratio":V.profit_ratio,"stake-currency":t(m).activeBot.stakeCurrency},null,8,["profit-ratio","stake-currency"])):p("",!0)]),l(E,{size:"sm",class:"ms-auto mt-auto",variant:"outline-secondary",onClick:I=>t(u)[D]=!t(u)[D]},{default:c(()=>[t(u)[D]?p("",!0):(r(),g(G,{key:0,width:"24",height:"24"})),t(u)[D]?(r(),g(y,{key:1,width:"24",height:"24"})):p("",!0)]),_:2},1032,["onClick"])]),l(X,{modelValue:t(u)[D],"onUpdate:modelValue":I=>t(u)[D]=I},{default:c(()=>{var I;return[d("ul",Tt,[(r(!0),b(P,null,K((I=V.orders)==null?void 0:I.filter(z=>z.order_filled_timestamp!==null),z=>(r(),b("li",{key:z.order_timestamp},R(z.ft_order_side)+" "+R(z.amount)+" at "+R(z.safe_price),1))),128))])]}),_:2},1032,["modelValue","onUpdate:modelValue"])]),_:2},1032,["title","active","onClick"]))),128)),e.trades.length===0?(r(),g(B,{key:0},{default:c(()=>h[3]||(h[3]=[w("No trades to show...")])),_:1})):p("",!0)]),_:1})])}}}),St=O(Vt,[["__scopeId","data-v-5f00175e"]]),At={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function qt(e,a){return r(),b("svg",At,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M15.41 16.58L10.83 12l4.58-4.59L14 6l-6 6l6 6z"},null,-1)]))}const ve=F({name:"mdi-chevron-left",render:qt}),Mt={class:"d-flex flex-row mb-1 align-items-center"},Lt={class:"me-2"},Pt={class:"flex-fill"},Ut={class:"col-md-1 text-end"},Dt={class:"text-center d-flex flex-row h-100 align-items-stretch"},It=S({__name:"BacktestResultChart",props:{timeframe:{},strategy:{},freqaiModel:{},timerange:{},backtestResult:{}},setup(e){const a=H(),n=A({right:!0,left:!0}),_=A(),m=s=>{_.value={startValue:s.open_timestamp,endValue:s.close_timestamp}};return(s,i)=>{const o=re,f=ve,v=N,x=Ye,u=Qe,$=St,h=be,C=Q;return r(),b("div",null,[d("div",Mt,[d("div",Lt,[l(v,{"aria-label":"Close",title:"Pair Navigation",variant:"outline-secondary",size:"sm",onClick:i[0]||(i[0]=B=>t(n).left=!t(n).left)},{default:c(()=>[t(n).left?p("",!0):(r(),g(o,{key:0,width:"24",height:"24"})),t(n).left?(r(),g(f,{key:1,width:"24",height:"24"})):p("",!0)]),_:1})]),d("span",Pt,[i[2]||(i[2]=w(" Graph will always show the latest values for the selected strategy. ")),i[3]||(i[3]=d("br",null,null,-1)),w(" Timerange: "+R(s.timerange)+" - "+R(s.strategy),1)]),d("div",Ut,[l(v,{"aria-label":"Close",variant:"outline-secondary",title:"Trade Navigation",size:"sm",onClick:i[1]||(i[1]=B=>t(n).right=!t(n).right)},{default:c(()=>[t(n).right?(r(),g(o,{key:0,width:"24",height:"24"})):p("",!0),t(n).right?p("",!0):(r(),g(f,{key:1,width:"24",height:"24"}))]),_:1})])]),d("div",Dt,[l(se,{name:"fadeleft"},{default:c(()=>[t(n).left?(r(),g(x,{key:0,class:"col-md-2 overflow-y-auto overflow-x-hidden",style:{"max-height":"calc(100vh - 200px)"},pairlist:s.backtestResult.pairlist,trades:s.backtestResult.trades,"starting-balance":s.backtestResult.starting_balance,"sort-method":"profit","backtest-mode":!0},null,8,["pairlist","trades","starting-balance"])):p("",!0)]),_:1}),l(u,{"available-pairs":s.backtestResult.pairlist,"historic-view":!0,timeframe:s.timeframe,timerange:s.timerange,strategy:s.strategy,trades:s.backtestResult.trades,class:"flex-shrink-1 candle-chart-container w-100 px-0 h-100 align-self-stretch","slider-position":t(_),"freqai-model":s.freqaiModel},null,8,["available-pairs","timeframe","timerange","strategy","trades","slider-position","freqai-model"]),l(se,{name:"fade"},{default:c(()=>[t(n).right?(r(),g($,{key:0,class:"overflow-y-auto col-md-2 overflow-x-visible",style:{"max-height":"calc(100vh - 200px)"},trades:s.backtestResult.trades.filter(B=>B.pair===t(a).activeBot.selectedPair),onTradeSelect:m},null,8,["trades"])):p("",!0)]),_:1})]),l(C,{header:"Single trades",class:"row mt-2 w-100"},{default:c(()=>[l(h,{class:"row trade-history mt-2 w-100",trades:s.backtestResult.trades,"show-filter":!0},null,8,["trades"])]),_:1})])}}}),zt=O(It,[["__scopeId","data-v-04f0146b"]]),ee="Market change %",Ft=S({__name:"MarketChangeChart",props:{marketChangeData:{type:Object,required:!0},showTitle:{type:Boolean,default:!0}},setup(e){nt([mt,ut,lt,_t,ot,ft,it,rt,ct,pt]);const a=e,n=Ce(),_=A(null),m=M(()=>{if(!a.marketChangeData)return{};const s=a.marketChangeData.columns.findIndex(o=>o==="__date_ts"),i=a.marketChangeData.columns.findIndex(o=>o==="rel_mean");return{title:{text:"Market change %",left:"center",show:a.showTitle},backgroundColor:"rgba(0, 0, 0, 0)",dataset:{source:a.marketChangeData.data},tooltip:{trigger:"axis",axisPointer:{type:"line",label:{backgroundColor:"#6a7985"}}},grid:{...kt},legend:{data:[ee],right:"5%"},xAxis:[{type:"time",axisLine:{onZero:!1},axisTick:{show:!0},axisLabel:{show:!0},axisPointer:{label:{show:!1}},splitLine:{show:!1},splitNumber:20,min:"dataMin",max:"dataMax"}],yAxis:[{type:"value",name:ee,splitLine:{show:!1},nameRotate:90,nameLocation:"middle",nameGap:35}],dataZoom:[{type:"inside",start:0,end:100},{bottom:10,start:0,end:100,...bt}],series:[{type:"line",name:ee,showSymbol:!1,color:n.chartTheme==="dark"?"#c2c2c2":"black",encode:{x:s,y:i}}]}});return(s,i)=>{var o;return(o=e.marketChangeData)!=null&&o.data?(r(),g(t(dt),{key:0,ref_key:"marketChangeChart",ref:_,option:t(m),theme:t(n).chartTheme,autoresize:""},null,8,["option","theme"])):p("",!0)}}}),Ht=O(Ft,[["__scopeId","data-v-94b99d11"]]),Nt={class:"text-center flex-fill d-flex flex-column h-100 gap-1"},Et=S({__name:"BacktestGraphs",props:{trades:{required:!0,type:Array}},setup(e){const a=H(),{state:n}=Te(()=>a.activeBot.getBacktestMarketChange(),null);return(_,m)=>{const s=tt,i=at,o=Ht,f=st;return r(),b("div",Nt,[l(s,{trades:e.trades,class:"flex-grow-1 chart-equal-height"},null,8,["trades"]),l(i,{trades:e.trades,class:"flex-grow-1 chart-equal-height","show-title":!0},null,8,["trades"]),t(n)?(r(),g(o,{key:0,"market-change-data":t(n),class:"flex-grow-1 chart-equal-height"},null,8,["market-change-data"])):p("",!0),l(f,{class:"flex-grow-1 chart-equal-height",trades:e.trades,"show-title":!0},null,8,["trades"])])}}}),Ot=O(Et,[["__scopeId","data-v-41b15471"]]),jt={class:"d-flex flex-column me-2 text-start"},Gt={class:"fw-bold"},Wt={class:"text-small"},Kt={key:0,class:"text-small",style:{"white-space":"pre-wrap"}},he=S({__name:"BacktestResultSelectEntry",props:{backtestResult:{required:!0,type:Object},selectedBacktestResultKey:{required:!1,default:"",type:String},canUseModify:{required:!1,default:!1,type:Boolean}},setup(e){return(a,n)=>(r(),b("div",jt,[d("div",Gt,R(e.backtestResult.metadata.strategyName)+" - "+R(e.backtestResult.strategy.timeframe),1),d("div",Wt," TradeCount: "+R(e.backtestResult.strategy.total_trades)+" - Profit: "+R(("formatPercent"in a?a.formatPercent:t(T))(e.backtestResult.strategy.profit_total)),1),e.canUseModify?(r(),b("div",Kt,R(e.backtestResult.metadata.notes),1)):p("",!0)]))}});function Zt(e){return e.slice().sort((n,_)=>n.profit_ratio-_.profit_ratio)}function Jt(e){if(e.length===0)return"N/A";const a=e[e.length-1];return`${a.pair} ${T(a.profit_ratio,2)}`}function Qt(e){if(e.length===0)return"N/A";const a=e[0];return`${a.pair} ${T(a.profit_ratio,2)}`}function xe(e,a){return _=>`${oe(_,e)} ${a}`}function Be(e){const a=Zt(e.trades),n=Jt(a),_=Qt(a),m=e.results_per_pair[e.results_per_pair.length-1],s=xe(e.stake_currency_decimals,e.stake_currency),i=e.trade_count_short&&e.trade_count_short>0?[{"___ ":"___"},{"Long / Short":`${e.trade_count_long} / ${e.trade_count_short}`},{"Total profit Long":`${T(e.profit_total_long||0)} | ${s(e.profit_total_long_abs)}`},{"Total profit Short":`${T(e.profit_total_short||0)} | ${s(e.profit_total_short_abs)}`}]:[];return[{"Total Profit":`${T(e.profit_total)} | ${s(e.profit_total_abs)}`},{CAGR:`${e.cagr?T(e.cagr):"N/A"}`},{Sortino:`${e.sortino?e.sortino.toFixed(2):"N/A"}`},{Sharpe:`${e.sharpe?e.sharpe.toFixed(2):"N/A"}`},{Calmar:`${e.calmar?e.calmar.toFixed(2):"N/A"}`},{[`Expectancy ${e.expectancy_ratio?"(ratio)":""}`]:`${e.expectancy?e.expectancy_ratio?e.expectancy.toFixed(2)+" ("+e.expectancy_ratio.toFixed(2)+")":e.expectancy.toFixed(2):"N/A"}`},{"Profit factor":`${e.profit_factor?oe(e.profit_factor,3):"N/A"}`},{"Total trades / Daily Avg Trades":`${e.total_trades} / ${e.trades_per_day}`},{"Best day":`${T(e.backtest_best_day,2)} | ${s(e.backtest_best_day_abs)}`},{"Worst day":`${T(e.backtest_worst_day,2)} | ${s(e.backtest_worst_day_abs)}`},{"Win/Draw/Loss":`${m.wins} / ${m.draws} / ${m.losses} ${Ve(m.winrate)?"(WR: "+T(e.results_per_pair[e.results_per_pair.length-1].winrate??0,2)+")":""}`},{"Days win/draw/loss":`${e.winning_days} / ${e.draw_days} / ${e.losing_days}`},{"Avg. Duration winners":ne(e.winner_holding_avg_s)},{"Avg. Duration Losers":ne(e.loser_holding_avg_s)},{"Max Consecutive Wins / Loss":e.max_consecutive_wins===void 0?"N/A":`${e.max_consecutive_wins} / ${e.max_consecutive_losses}`},{"Rejected entry signals":e.rejected_signals},{"Entry/Exit timeouts":`${e.timedout_entry_orders} / ${e.timedout_exit_orders}`},{"Canceled Trade Entries":e.canceled_trade_entries??"N/A"},{"Canceled Entry Orders":e.canceled_entry_orders??"N/A"},{"Replaced Entry Orders":e.replaced_entry_orders??"N/A"},...i,{___:"___"},{"Min balance":s(e.csum_min)},{"Max balance":s(e.csum_max)},{"Market change":T(e.market_change)},{"___  ":"___"},{"Max Drawdown (Account)":T(e.max_drawdown_account)},{"Max Drawdown ABS":s(e.max_drawdown_abs)},{"Drawdown high | low":`${s(e.max_drawdown_high)} | ${s(e.max_drawdown_low)}`},{"Drawdown start":Z(e.drawdown_start_ts)},{"Drawdown end":Z(e.drawdown_end_ts)},{"___   ":"___"},{"Best Pair":`${e.best_pair.key} ${T(e.best_pair.profit_total)}`},{"Worst Pair":`${e.worst_pair.key} ${T(e.worst_pair.profit_total)}`},{"Best single Trade":n},{"Worst single Trade":_}]}function te(e){return e.charAt(0).toUpperCase()+e.slice(1)}function Xt(e){return!e.trading_mode||!e.margin_mode?{}:{"Trading Mode":e.trading_mode==="spot"?te(e.trading_mode):`${te(e.margin_mode)} ${te(e.trading_mode)}`}}function Yt(e){const a=xe(e.stake_currency_decimals,e.stake_currency),n=Xt(e);return[{"Backtesting from":Z(e.backtest_start_ts)},{"Backtesting to":Z(e.backtest_end_ts)},...Object.keys(n).length!==0?[n]:[],{"BT execution time":ne(e.backtest_run_end_ts-e.backtest_run_start_ts)},{"Max open trades":e.max_open_trades},{Timeframe:e.timeframe},{"Timeframe Detail":e.timeframe_detail||"N/A"},{Timerange:e.timerange},{Stoploss:T(e.stoploss,2)},{"Trailing Stoploss":e.trailing_stop},{"Trail only when offset is reached":e.trailing_only_offset_is_reached},{"Trailing Stop positive":e.trailing_stop_positive},{"Trailing stop positive offset":e.trailing_stop_positive_offset},{"Custom Stoploss":e.use_custom_stoploss},{ROI:JSON.stringify(e.minimal_roi)},{"Use Exit Signal":e.use_exit_signal!==void 0?e.use_exit_signal:e.use_sell_signal},{"Exit profit only":e.exit_profit_only!==void 0?e.exit_profit_only:e.sell_profit_only},{"Exit profit offset":e.exit_profit_offset!==void 0?e.exit_profit_offset:e.sell_profit_offset},{"Enable protections":e.enable_protections},{"Starting balance":a(e.starting_balance)},{"Final balance":a(e.final_balance)},{"Avg. stake amount":a(e.avg_stake_amount)},{"Total trade volume":a(e.total_volume)}]}function le(e,a){return Object.entries(e).reduce((_,[m,s])=>(s.forEach(i=>{const[o,f]=Object.entries(i)[0],v=_.find(x=>x[a]===o);v?v[m]=f:_.push({[a]:o,[m]:f})}),_),[])}const ea={class:"px-0 mw-100"},ta={class:"d-flex flex-column text-start ms-0 me-2 gap-2"},aa={class:"d-flex flex-column flex-xl-row"},sa={class:"px-0 px-xl-0 pt-2 pt-xl-0 ps-xl-1 flex-fill"},na=S({__name:"BacktestResultComparison",props:{backtestResults:{required:!0,type:Object}},setup(e){const a=e,n=M(()=>{const m={};return Object.entries(a.backtestResults).forEach(([s,i])=>{const o=Be(i.strategy);m[s]=o}),console.log(m),le(m,"metric")}),_=M(()=>{const m=[{key:"metric",label:"Metric"}];return Object.entries(a.backtestResults).forEach(([s,i])=>{m.push({key:s,label:i.metadata.strategyName})}),m});return(m,s)=>{const i=he,o=J;return r(),b("div",ea,[s[0]||(s[0]=d("div",{class:"d-flex justify-content-center"},[d("h3",null,"Backtest-result comparison")],-1)),d("div",ta,[d("div",aa,[d("div",sa,[l(o,{bordered:"",items:t(n),fields:t(_)},Se({_:2},[K(Object.entries(e.backtestResults),([f,v])=>({name:`head(${f})`,fn:c(()=>[l(i,{"backtest-result":v},null,8,["backtest-result"])])}))]),1032,["items","fields"])])])])])}}}),la=S({__name:"BacktestResultPeriodBreakdown",props:{periodicBreakdown:{type:Object,required:!0}},setup(e){const a=[{value:"day",text:"Days"},{value:"week",text:"Weeks"},{value:"month",text:"Months"}],n=A("month"),_=M(()=>[{key:"date",label:"Date"},{key:"wins",label:"Wins"},{key:"draws",label:"Draws"},{key:"loses",label:"Losses"}]);return(m,s)=>{const i=ye,o=J;return r(),b(P,null,[l(i,{id:"order-direction",modelValue:t(n),"onUpdate:modelValue":s[0]||(s[0]=f=>U(n)?n.value=f:null),options:a,name:"radios-btn-default",size:"sm",buttons:"",style:{"min-width":"10em"},"button-variant":"outline-primary"},null,8,["modelValue"]),l(o,{small:"",hover:"",stacked:"sm",items:e.periodicBreakdown[t(n)],fields:t(_)},null,8,["items","fields"])],64)}}}),oa=S({__name:"BacktestResultTablePer",props:{title:{type:String,required:!0},results:{type:Array,required:!0},stakeCurrency:{type:String,required:!0},stakeCurrencyDecimals:{type:Number,required:!0},keyHeader:{type:String,default:""},keyHeaders:{type:Array,default:()=>[]}},setup(e){const a=e,n=M(()=>a.results.map(m=>a.keyHeaders.length>0?{...m,key:typeof m.key=="string"?Array(a.keyHeaders.length).fill(m.key):m.key}:m)),_=M(()=>{const m=[];if(a.keyHeaders.length>0)for(let s=0;s<a.keyHeaders.length;s+=1)m.push({key:`key[${s}]`,label:a.keyHeaders[s],formatter:(i,o,f)=>Array.isArray(i)?i[s]:i||f.exit_reason||"OTHER"});else m.push({key:"key",label:a.keyHeader,formatter:(s,i,o)=>s||o.exit_reason||"OTHER"});return[...m,{key:"trades",label:"Trades"},{key:"profit_mean",label:"Avg Profit %",formatter:s=>T(s,2)},{key:"profit_total_abs",label:`Tot Profit ${a.stakeCurrency}`,formatter:s=>oe(s,a.stakeCurrencyDecimals)},{key:"profit_total",label:"Tot Profit %",formatter:s=>T(s,2)},{key:"wins",label:"Wins"},{key:"draws",label:"Draws"},{key:"losses",label:"Losses"}]});return console.log(a.title,"xxx",_),(m,s)=>{const i=J,o=Q;return r(),g(o,{header:e.title},{default:c(()=>[l(i,{small:"",hover:"",stacked:"sm",items:t(n),fields:t(_)},null,8,["items","fields"])]),_:1},8,["header"])}}}),ia={class:"px-0 mw-100"},ra={class:"d-flex justify-content-center"},ca={class:"d-flex flex-column text-start ms-0 me-2 gap-2"},da={class:"d-flex flex-column flex-xl-row"},ma={class:"px-0 px-xl-0 pe-xl-1 flex-fill"},ua={class:"px-0 px-xl-0 pt-2 pt-xl-0 ps-xl-1 flex-fill"},_a=S({__name:"BacktestResultAnalysis",props:{backtestResult:{required:!0,type:Object}},setup(e){const a=e,n=M(()=>{const i=Be(a.backtestResult);return le({value:i},"metric")}),_=M(()=>{const i=Yt(a.backtestResult);return le({value:i},"setting")}),m=[{key:"metric",label:"Metric"},{key:"value",label:"Value"}],s=[{key:"setting",label:"Setting"},{key:"value",label:"Value"}];return(i,o)=>{const f=J,v=Q,x=oa,u=la,$=be;return r(),b("div",ia,[d("div",ra,[d("h3",null,"Backtest-result for "+R(e.backtestResult.strategy_name),1)]),d("div",ca,[d("div",da,[d("div",ma,[l(v,{header:"Strategy settings"},{default:c(()=>[l(f,{small:"",borderless:"",items:t(_),fields:s},null,8,["items"])]),_:1})]),d("div",ua,[l(v,{header:"Metrics"},{default:c(()=>[l(f,{small:"",borderless:"",items:t(n),fields:m},null,8,["items"])]),_:1})])]),l(x,{title:"Results per Enter tag",results:e.backtestResult.results_per_enter_tag,"stake-currency":e.backtestResult.stake_currency,"key-header":"Enter Tag","stake-currency-decimals":e.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),l(x,{title:"Results per Exit reason",results:e.backtestResult.exit_reason_summary??[],"stake-currency":e.backtestResult.stake_currency,"key-header":"Exit Reason","stake-currency-decimals":e.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),e.backtestResult.mix_tag_stats?(r(),g(x,{key:0,title:"Results Mixed Tag",results:e.backtestResult.mix_tag_stats??[],"stake-currency":e.backtestResult.stake_currency,"key-headers":["Enter Tag","Exit Tag"],"stake-currency-decimals":e.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"])):p("",!0),l(x,{title:"Results per pair",results:e.backtestResult.results_per_pair,"stake-currency":e.backtestResult.stake_currency,"key-header":"Pair","stake-currency-decimals":e.backtestResult.stake_currency_decimals},null,8,["results","stake-currency","stake-currency-decimals"]),e.backtestResult.periodic_breakdown?(r(),g(v,{key:1,header:"Periodic breakdown"},{default:c(()=>[l(u,{"periodic-breakdown":e.backtestResult.periodic_breakdown},null,8,["periodic-breakdown"])]),_:1})):p("",!0),l(v,{header:"Single trades"},{default:c(()=>[l($,{trades:e.backtestResult.trades,"show-filter":!0,"stake-currency":e.backtestResult.stake_currency},null,8,["trades","stake-currency"])]),_:1})])])}}}),fa={class:"w-100 d-flex"},pa={class:"ms-2"},ka=S({__name:"FreqaiModelSelect",props:{modelValue:{},modelModifiers:{}},emits:["update:modelValue"],setup(e){const a=Ae(e,"modelValue"),n=H();return ie(()=>{n.activeBot.freqaiModelList.length===0&&n.activeBot.getFreqAIModelList()}),(_,m)=>{const s=yt,i=ue,o=N;return r(),b("div",null,[d("div",fa,[l(s,{id:"freqaiModel-select",modelValue:a.value,"onUpdate:modelValue":m[0]||(m[0]=f=>a.value=f),options:t(n).activeBot.freqaiModelList},null,8,["modelValue","options"]),d("div",pa,[l(o,{onClick:t(n).activeBot.getFreqAIModelList},{default:c(()=>[l(i)]),_:1},8,["onClick"])])])])}}}),$e=qe("btStore",{state:()=>({strategy:"",selectedTimeframe:"",selectedDetailTimeframe:"",timerange:"",maxOpenTrades:"",stakeAmount:"",startingCapital:"",allowCache:!0,enableProtections:!1,stakeAmountUnlimited:!1,freqAI:{enabled:!1,model:"",identifier:""}}),getters:{canRunBacktest:e=>e.strategy!==""},actions:{}}),ba={class:"mb-2"},ga={class:"d-flex align-items-center"},ya={style:{"flex-basis":"100%"},class:"d-flex"},va={class:"d-flex justify-content-center"},ha={class:"d-flex flex-wrap flex-md-nowrap justify-content-between justify-content-md-center"},xa=S({__name:"BacktestRun",setup(e){const a=H(),n=$e();function _(){const m={strategy:n.strategy,timerange:n.timerange,enable_protections:n.enableProtections},s=parseInt(n.maxOpenTrades,10);if(s&&(m.max_open_trades=s),n.stakeAmountUnlimited)m.stake_amount="unlimited";else{const o=Number(n.stakeAmount);o&&(m.stake_amount=o.toString())}const i=Number(n.startingCapital);i&&(m.dry_run_wallet=i),n.selectedTimeframe&&(m.timeframe=n.selectedTimeframe),n.selectedDetailTimeframe&&(m.timeframe_detail=n.selectedDetailTimeframe),n.allowCache||(m.backtest_cache="none"),n.freqAI.enabled&&(m.freqaimodel=n.freqAI.model,n.freqAI.identifier!==""&&(m.freqai={identifier:n.freqAI.identifier})),a.activeBot.startBacktest(m)}return(m,s)=>{const i=vt,o=ht,f=_e,v=fe,x=Me,u=ge,$=ka,h=gt,C=Q,B=N;return r(),b(P,null,[d("div",ba,[s[13]||(s[13]=d("span",null,"Strategy",-1)),l(i,{modelValue:t(n).strategy,"onUpdate:modelValue":s[0]||(s[0]=k=>t(n).strategy=k)},null,8,["modelValue"])]),l(C,{disabled:t(a).activeBot.backtestRunning},{default:c(()=>[l(f,{"label-cols-lg":"2",label:"Backtest params","label-size":"sm","label-class":"fw-bold pt-0",class:"mb-0"},{default:c(()=>[l(f,{"label-cols-sm":"5",label:"Timeframe:","label-align-sm":"right","label-for":"timeframe-select"},{default:c(()=>[l(o,{id:"timeframe-select",modelValue:t(n).selectedTimeframe,"onUpdate:modelValue":s[1]||(s[1]=k=>t(n).selectedTimeframe=k)},null,8,["modelValue"])]),_:1}),l(f,{"label-cols-sm":"5",label:"Detail Timeframe:","label-align-sm":"right","label-for":"timeframe-detail-select",title:"Detail timeframe, to simulate intra-candle results. Not setting this will not use this functionality."},{default:c(()=>[l(o,{id:"timeframe-detail-select",modelValue:t(n).selectedDetailTimeframe,"onUpdate:modelValue":s[2]||(s[2]=k=>t(n).selectedDetailTimeframe=k),"below-timeframe":t(n).selectedTimeframe},null,8,["modelValue","below-timeframe"])]),_:1}),l(f,{"label-cols-sm":"5",label:"Max open trades:","label-align-sm":"right","label-for":"max-open-trades"},{default:c(()=>[l(v,{id:"max-open-trades",modelValue:t(n).maxOpenTrades,"onUpdate:modelValue":s[3]||(s[3]=k=>t(n).maxOpenTrades=k),placeholder:"Use strategy default",type:"number"},null,8,["modelValue"])]),_:1}),l(f,{"label-cols-sm":"5",label:"Starting capital:","label-align-sm":"right","label-for":"starting-capital"},{default:c(()=>[l(v,{id:"starting-capital",modelValue:t(n).startingCapital,"onUpdate:modelValue":s[4]||(s[4]=k=>t(n).startingCapital=k),placeholder:"Use config default",type:"number",step:"0.001"},null,8,["modelValue"])]),_:1}),l(f,{"label-cols-sm":"5",label:"Stake amount:","label-align-sm":"right","label-for":"stake-amount"},{default:c(()=>[d("div",ga,[d("div",ya,[l(x,{id:"stake-amount-bool",modelValue:t(n).stakeAmountUnlimited,"onUpdate:modelValue":s[5]||(s[5]=k=>t(n).stakeAmountUnlimited=k)},{default:c(()=>s[14]||(s[14]=[w("Unlimited stake")])),_:1},8,["modelValue"])]),l(v,{id:"stake-amount",modelValue:t(n).stakeAmount,"onUpdate:modelValue":s[6]||(s[6]=k=>t(n).stakeAmount=k),type:"number",placeholder:"Use strategy default",step:"0.01",style:{"flex-basis":"100%"},disabled:t(n).stakeAmountUnlimited},null,8,["modelValue","disabled"])])]),_:1}),l(f,{"label-cols-sm":"5",label:"Enable Protections:","label-align-sm":"right","label-for":"enable-protections",class:"align-items-center"},{default:c(()=>[l(x,{id:"enable-protections",modelValue:t(n).enableProtections,"onUpdate:modelValue":s[7]||(s[7]=k=>t(n).enableProtections=k)},null,8,["modelValue"])]),_:1}),t(a).activeBot.botApiVersion>=2.22?(r(),g(f,{key:0,"label-cols-sm":"5",label:"Cache Backtest results:","label-align-sm":"right","label-for":"enable-cache",class:"align-items-center"},{default:c(()=>[l(x,{id:"enable-cache",modelValue:t(n).allowCache,"onUpdate:modelValue":s[8]||(s[8]=k=>t(n).allowCache=k)},null,8,["modelValue"])]),_:1})):p("",!0),t(a).activeBot.botApiVersion>=2.22?(r(),b(P,{key:1},[l(f,{"label-cols-sm":"5",label:"Enable FreqAI:","label-align-sm":"right","label-for":"enable-freqai",class:"align-items-center"},{label:c(()=>[d("div",va,[s[15]||(s[15]=d("span",{class:"me-2"},"Enable FreqAI:",-1)),l(u,{hint:"Assumes freqAI configuration is setup in the configuration, and the strategy is a freqAI strategy. Will fail if that's not the case."})])]),default:c(()=>[l(x,{id:"enable-freqai",modelValue:t(n).freqAI.enabled,"onUpdate:modelValue":s[9]||(s[9]=k=>t(n).freqAI.enabled=k)},null,8,["modelValue"])]),_:1}),t(n).freqAI.enabled?(r(),g(f,{key:0,"label-cols-sm":"5",label:"FreqAI identifier:","label-align-sm":"right","label-for":"freqai-identifier"},{default:c(()=>[l(v,{id:"freqai-identifier",modelValue:t(n).freqAI.identifier,"onUpdate:modelValue":s[10]||(s[10]=k=>t(n).freqAI.identifier=k),placeholder:"Use config default"},null,8,["modelValue"])]),_:1})):p("",!0),t(n).freqAI.enabled?(r(),g(f,{key:1,"label-cols-sm":"5",label:"FreqAI Model","label-align-sm":"right","label-for":"freqai-model"},{default:c(()=>[l($,{id:"freqai-model",modelValue:t(n).freqAI.model,"onUpdate:modelValue":s[11]||(s[11]=k=>t(n).freqAI.model=k)},null,8,["modelValue"])]),_:1})):p("",!0)],64)):p("",!0),s[16]||(s[16]=d("hr",null,null,-1)),l(h,{modelValue:t(n).timerange,"onUpdate:modelValue":s[12]||(s[12]=k=>t(n).timerange=k),class:"mt-2"},null,8,["modelValue"])]),_:1})]),_:1},8,["disabled"]),s[21]||(s[21]=d("h3",{class:"mt-3"},"Backtesting summary",-1)),d("div",ha,[l(B,{id:"start-backtest",variant:"primary",disabled:!t(n).canRunBacktest||t(a).activeBot.backtestRunning||!t(a).activeBot.canRunBacktest,class:"mx-1",onClick:_},{default:c(()=>s[17]||(s[17]=[w(" Start backtest ")])),_:1},8,["disabled"]),l(B,{variant:"secondary",disabled:t(a).activeBot.backtestRunning||!t(a).activeBot.canRunBacktest,class:"mx-1",onClick:t(a).activeBot.pollBacktest},{default:c(()=>s[18]||(s[18]=[w(" Load backtest result ")])),_:1},8,["disabled","onClick"]),l(B,{variant:"secondary",class:"mx-1",disabled:!t(a).activeBot.backtestRunning,onClick:t(a).activeBot.stopBacktest},{default:c(()=>s[19]||(s[19]=[w("Stop Backtest")])),_:1},8,["disabled","onClick"]),l(B,{variant:"secondary",class:"mx-1",disabled:t(a).activeBot.backtestRunning||!t(a).activeBot.canRunBacktest,onClick:t(a).activeBot.removeBacktest},{default:c(()=>s[20]||(s[20]=[w("Reset Backtest")])),_:1},8,["disabled","onClick"])])],64)}}}),Ba={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function $a(e,a){return r(),b("svg",Ba,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M4 11v2h12l-5.5 5.5l1.42 1.42L19.84 12l-7.92-7.92L10.5 5.5L16 11z"},null,-1)]))}const wa=F({name:"mdi-arrow-right",render:$a}),Ra={class:"d-flex align-items-center"},Ca={key:0,class:"ms-1"},Ta={class:"d-flex align-items-center"},Va=S({__name:"BacktestHistoryLoad",setup(e){const a=H(),n=A(),_=A(""),m=Le(_,350,{maxWait:1e3});ie(()=>{a.activeBot.getBacktestHistory()});function s(i){var f;const o={title:"Delete result",message:`Delete result ${i.filename} from disk?`,accept:()=>{a.activeBot.deleteBacktestHistoryResult(i)}};(f=n.value)==null||f.show(o)}return(i,o)=>{const f=ue,v=fe,x=_e,u=Pe,$=Ue,h=De,C=Ie,B=wa,k=N,L=ke,j=ze,G=Fe;return r(),b(P,null,[d("div",null,[d("button",{class:"btn btn-secondary float-end",title:"Refresh","aria-label":"Refresh",onClick:o[0]||(o[0]=(...y)=>t(a).activeBot.getBacktestHistory&&t(a).activeBot.getBacktestHistory(...y))},[l(f)]),o[7]||(o[7]=d("p",null," Load Historic results from disk. You can click on multiple results to load all of them into freqUI. ",-1)),d("div",Ra,[t(a).activeBot.backtestHistoryList.length>0?(r(),g(x,{key:0,class:"my-2","label-for":"trade-filter"},{default:c(()=>[l(v,{id:"trade-filter",modelValue:t(_),"onUpdate:modelValue":o[1]||(o[1]=y=>U(_)?_.value=y:null),type:"text",placeholder:"Filter Strategies",tilte:"Filter Strategies"},null,8,["modelValue"])]),_:1})):p("",!0)]),t(a).activeBot.backtestHistoryList.length>0?(r(),g(G,{key:0,responsive:"",small:"",class:"rounded-1 table-rounded-corners"},{default:c(()=>[l(h,null,{default:c(()=>[l($,null,{default:c(()=>[l(u,null,{default:c(()=>o[2]||(o[2]=[w("Strategy")])),_:1}),l(u,null,{default:c(()=>o[3]||(o[3]=[w("Details")])),_:1}),l(u,null,{default:c(()=>o[4]||(o[4]=[w("Backtest Time")])),_:1}),l(u,null,{default:c(()=>o[5]||(o[5]=[w("Filename")])),_:1}),l(u,null,{default:c(()=>o[6]||(o[6]=[w("Actions")])),_:1})]),_:1})]),_:1}),l(j,null,{default:c(()=>[(r(!0),b(P,null,K(t(a).activeBot.backtestHistoryList.filter(y=>y.filename.toLowerCase().includes(t(m).toLowerCase())||y.strategy.toLowerCase().includes(t(m).toLowerCase())),y=>(r(),g($,{key:y.filename+y.strategy,role:"button",onClick:E=>t(a).activeBot.getBacktestHistoryResult(y)},{default:c(()=>[l(C,null,{default:c(()=>[w(R(y.strategy),1)]),_:2},1024),l(C,null,{default:c(()=>[d("strong",null,R(y.timeframe),1),y.backtest_start_ts&&y.backtest_end_ts?(r(),b("span",Ca,R(("timestampToTimeRangeString"in i?i.timestampToTimeRangeString:t(ce))(y.backtest_start_ts*1e3))+"-"+R(("timestampToTimeRangeString"in i?i.timestampToTimeRangeString:t(ce))(y.backtest_end_ts*1e3)),1)):p("",!0)]),_:2},1024),l(C,null,{default:c(()=>[d("small",null,R(("timestampms"in i?i.timestampms:t(Z))(y.backtest_start_time*1e3)),1)]),_:2},1024),l(C,null,{default:c(()=>[d("small",null,R(y.filename),1)]),_:2},1024),l(C,null,{default:c(()=>[d("div",Ta,[t(a).activeBot.botApiVersion>=2.32?(r(),g(ge,{key:0,class:pe(y.notes?"opacity-100":"opacity-0"),hint:y.notes??""},null,8,["class","hint"])):p("",!0),t(a).activeBot.botApiVersion>=2.31?(r(),g(k,{key:1,class:"ms-1",size:"sm",title:"Load this Result.",disabled:y.run_id in t(a).activeBot.backtestHistory,onClick:W(E=>t(a).activeBot.getBacktestHistoryResult(y),["stop"])},{default:c(()=>[l(B)]),_:2},1032,["disabled","onClick"])):p("",!0),t(a).activeBot.botApiVersion>=2.31?(r(),g(k,{key:2,class:"ms-1",size:"sm",title:"Delete this Result.",disabled:y.run_id in t(a).activeBot.backtestHistory,onClick:W(E=>s(y),["stop"])},{default:c(()=>[l(L)]),_:2},1032,["disabled","onClick"])):p("",!0)])]),_:2},1024)]),_:2},1032,["onClick"]))),128))]),_:1})]),_:1})):p("",!0)]),l(et,{ref_key:"msgBox",ref:n},null,512)],64)}}}),Sa=O(Va,[["__scopeId","data-v-aa565cb2"]]),Aa={class:"container d-flex flex-column align-items-stretch"},qa={class:"d-flex"},Ma=S({__name:"BacktestResultSelect",props:{backtestHistory:{required:!0,type:Object},selectedBacktestResultKey:{required:!1,default:"",type:String},canUseModify:{required:!1,default:!1,type:Boolean}},emits:["selectionChange","removeResult","updateResult"],setup(e,{emit:a}){const n=a,_=s=>{n("selectionChange",s)};function m(s,i){i.metadata.editing=!i.metadata.editing,i.metadata.filename&&n("updateResult",{run_id:s,notes:i.metadata.notes??"",filename:i.metadata.filename,strategy:i.metadata.strategyName})}return(s,i)=>{const o=he,f=He,v=N,x=ke,u=Xe,$=Ne,h=de,C=me;return r(),b("div",Aa,[i[0]||(i[0]=d("h3",null,"Available results:",-1)),l(C,{class:"ms-2"},{default:c(()=>[(r(!0),b(P,null,K(Object.entries(e.backtestHistory),([B,k])=>(r(),g(h,{key:B,button:"",active:B===e.selectedBacktestResultKey,class:"d-flex justify-content-between align-items-center py-1 pe-1",onClick:L=>_(B)},{default:c(()=>[k.metadata.editing?p("",!0):(r(),b(P,{key:0},[l(o,{"backtest-result":k,"can-use-modify":e.canUseModify},null,8,["backtest-result","can-use-modify"]),d("div",qa,[e.canUseModify?(r(),g(v,{key:0,class:"flex-nowrap",size:"sm",title:"Modify result notes.",onClick:W(L=>k.metadata.editing=!k.metadata.editing,["stop"])},{default:c(()=>[l(f)]),_:2},1032,["onClick"])):p("",!0),l(v,{size:"sm",class:"flex-nowrap",title:"Delete this Result from UI.",onClick:W(L=>n("removeResult",B),["stop"])},{default:c(()=>[l(x)]),_:2},1032,["onClick"])])],64)),k.metadata.editing?(r(),b(P,{key:1},[l(u,{modelValue:k.metadata.notes,"onUpdate:modelValue":L=>k.metadata.notes=L,placeholder:"notes",size:"sm"},null,8,["modelValue","onUpdate:modelValue"]),l(v,{size:"sm",title:"Confirm",onClick:W(L=>m(B,k),["stop"])},{default:c(()=>[l($)]),_:2},1032,["onClick"])],64)):p("",!0)]),_:2},1032,["active","onClick"]))),128))]),_:1})])}}}),La={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Pa(e,a){return r(),b("svg",La,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M21 8c-1.5 0-2.3 1.4-1.9 2.5l-3.6 3.6c-.3-.1-.7-.1-1 0l-2.6-2.6c.4-1.1-.4-2.5-1.9-2.5c-1.4 0-2.3 1.4-1.9 2.5L3.5 16c-1.1-.3-2.5.5-2.5 2c0 1.1.9 2 2 2c1.4 0 2.3-1.4 1.9-2.5l4.5-4.6c.3.1.7.1 1 0l2.6 2.6c-.3 1 .5 2.5 2 2.5s2.3-1.4 1.9-2.5l3.6-3.6c1.1.3 2.5-.5 2.5-1.9c0-1.1-.9-2-2-2m-6 1l.9-2.1L18 6l-2.1-.9L15 3l-.9 2.1L12 6l2.1.9zM3.5 11L4 9l2-.5L4 8l-.5-2L3 8l-2 .5L3 9z"},null,-1)]))}const Ua=F({name:"mdi-chart-timeline-variant-shimmer",render:Pa}),Da={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ia(e,a){return r(),b("svg",Da,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M4 19v1h18v2H2V2h2v15c3 0 6-2 8.1-5.6c3-5 6.3-7.4 9.9-7.4v2c-2.8 0-5.5 2.1-8.1 6.5C11.3 16.6 7.7 19 4 19"},null,-1)]))}const za=F({name:"mdi-chart-bell-curve-cumulative",render:Ia}),Fa={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Ha(e,a){return r(),b("svg",Fa,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M9 14H2v2h7v3l4-4l-4-4zm6-1v-3h7V8h-7V5l-4 4z"},null,-1)]))}const Na=F({name:"mdi-compare-horizontal",render:Ha}),Ea={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Oa(e,a){return r(),b("svg",Ea,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M17 16.88c.56 0 1 .44 1 1s-.44 1-1 1s-1-.45-1-1s.44-1 1-1m0-3c2.73 0 5.06 1.66 6 4c-.94 2.34-3.27 4-6 4s-5.06-1.66-6-4c.94-2.34 3.27-4 6-4m0 1.5a2.5 2.5 0 0 0 0 5a2.5 2.5 0 0 0 0-5M18 3H4c-1.1 0-2 .9-2 2v12c0 1.1.9 2 2 2h5.42c-.16-.32-.3-.66-.42-1c.12-.34.26-.68.42-1H4v-4h6v2.97c.55-.86 1.23-1.6 2-2.21V13h1.15c1.16-.64 2.47-1 3.85-1c1.06 0 2.07.21 3 .59V5c0-1.1-.9-2-2-2m-8 8H4V7h6zm8 0h-6V7h6z"},null,-1)]))}const ja=F({name:"mdi-table-eye",render:Oa}),Ga={viewBox:"0 0 24 24",width:"1.2em",height:"1.2em"};function Wa(e,a){return r(),b("svg",Ga,a[0]||(a[0]=[d("path",{fill:"currentColor",d:"M6.5 20q-2.28 0-3.89-1.57Q1 16.85 1 14.58q0-1.95 1.17-3.48q1.18-1.53 3.08-1.95q.58-2.02 2.14-3.4Q8.95 4.38 11 4.08v8.07L9.4 10.6L8 12l4 4l4-4l-1.4-1.4l-1.6 1.55V4.08q2.58.35 4.29 2.31T19 11q1.73.2 2.86 1.5q1.14 1.28 1.14 3q0 1.88-1.31 3.19T18.5 20Z"},null,-1)]))}const Ka=F({name:"mdi-cloud-download",render:Wa}),Za={class:"d-flex flex-column pt-1 me-1",style:{height:"calc(100vh - 60px)"}},Ja={class:"d-flex flex-row"},Qa={key:0},Xa={class:"w-100"},Ya={class:"mx-md-5 d-flex flex-wrap justify-content-md-center justify-content-between mb-4 gap-2"},es={class:"d-flex flex-md-row h-100"},ts={class:"d-flex flex-column flex-fill mw-100 h-100"},as={class:"d-md-flex h-100"},ss={key:0,class:"flex-fill d-flex flex-column bt-config"},ns={key:1,class:"flex-fill d-flex flex-column bt-config"},ls={key:0,class:"text-center w-100 mt-2"},os=S({__name:"BacktestingView",setup(e){const a=H(),n=$e(),_=M(()=>a.activeBot.backtestHistory?Object.keys(a.activeBot.backtestHistory).length!==0:!1),m=M(()=>a.activeBot.backtestHistory?Object.keys(a.activeBot.backtestHistory).length>1:!1),s=M(()=>{try{return a.activeBot.selectedBacktestResult.timeframe}catch{return""}}),i=A(!1),o=A("run"),f=A(null),v=()=>{n.strategy=a.activeBot.selectedBacktestResult.strategy_name,a.activeBot.getStrategy(n.strategy),n.selectedTimeframe=a.activeBot.selectedBacktestResult.timeframe,n.selectedDetailTimeframe=a.activeBot.selectedBacktestResult.timeframe_detail||"",n.timerange=a.activeBot.selectedBacktestResult.timerange};return ae(()=>a.activeBot.selectedBacktestResultKey,()=>{v()}),ie(()=>a.activeBot.getState()),ae(()=>a.activeBot.backtestRunning,()=>{a.activeBot.backtestRunning===!0?f.value=window.setInterval(a.activeBot.pollBacktest,1e3):f.value&&(clearInterval(f.value),f.value=null)}),(x,u)=>{const $=Ka,h=Je,C=je,B=ja,k=Na,L=za,j=Ua,G=re,y=ve,E=N,X=Ma,Y=Sa,V=xa,D=_a,I=na,z=Ot,we=zt;return r(),b("div",Za,[d("div",null,[d("div",Ja,[u[13]||(u[13]=d("h2",{class:"ms-5"},"Backtesting",-1)),t(a).activeBot.canRunBacktest?p("",!0):(r(),b("p",Qa," Bot must be in webserver mode to enable Backtesting. ")),d("div",Xa,[d("div",Ya,[t(a).activeBot.botApiVersion>=2.15?(r(),g(h,{key:0,modelValue:t(o),"onUpdate:modelValue":u[0]||(u[0]=q=>U(o)?o.value=q:null),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"historicResults",disabled:!t(a).activeBot.canRunBacktest},{default:c(()=>[l($,{class:"me-2"}),u[7]||(u[7]=w("Load Results"))]),_:1},8,["modelValue","disabled"])):p("",!0),l(h,{modelValue:t(o),"onUpdate:modelValue":u[1]||(u[1]=q=>U(o)?o.value=q:null),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"run",disabled:!t(a).activeBot.canRunBacktest},{default:c(()=>[l(C,{class:"me-2"}),u[8]||(u[8]=w("Run backtest"))]),_:1},8,["modelValue","disabled"]),l(h,{id:"bt-analyze-btn",modelValue:t(o),"onUpdate:modelValue":u[2]||(u[2]=q=>U(o)?o.value=q:null),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"results",disabled:!t(_)},{default:c(()=>[l(B,{class:"me-2"}),u[9]||(u[9]=w("Analyze result"))]),_:1},8,["modelValue","disabled"]),t(m)?(r(),g(h,{key:1,modelValue:t(o),"onUpdate:modelValue":u[3]||(u[3]=q=>U(o)?o.value=q:null),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"compare-results",disabled:!t(m)},{default:c(()=>[l(k,{class:"me-2"}),u[10]||(u[10]=w("Compare results"))]),_:1},8,["modelValue","disabled"])):p("",!0),l(h,{modelValue:t(o),"onUpdate:modelValue":u[4]||(u[4]=q=>U(o)?o.value=q:null),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"visualize-summary",disabled:!t(_)},{default:c(()=>[l(L,{class:"me-2"}),u[11]||(u[11]=w("Visualize summary"))]),_:1},8,["modelValue","disabled"]),l(h,{modelValue:t(o),"onUpdate:modelValue":u[5]||(u[5]=q=>U(o)?o.value=q:null),name:"bt-form-radios",button:"",class:"mx-1 flex-samesize-items",value:"visualize",disabled:!t(_)},{default:c(()=>[l(j,{class:"me-2"}),u[12]||(u[12]=w("Visualize result"))]),_:1},8,["modelValue","disabled"])]),Ee(d("small",{class:"text-end bt-running-label"},"Backtest running: "+R(t(a).activeBot.backtestStep)+" "+R(("formatPercent"in x?x.formatPercent:t(T))(t(a).activeBot.backtestProgress,2)),513),[[Oe,t(a).activeBot.backtestRunning]])])])]),d("div",es,[t(o)!=="visualize"?(r(),b("div",{key:0,class:pe([`${t(i)?"col-md-3":""}`,"sticky-top sticky-offset me-3 d-flex flex-column absolute"]),style:{"max-height":"calc(100vh - 60px)"}},[l(E,{class:"align-self-start","aria-label":"Close",size:"sm",variant:"outline-secondary",onClick:u[6]||(u[6]=q=>i.value=!t(i))},{default:c(()=>[t(i)?p("",!0):(r(),g(G,{key:0,width:"24",height:"24"})),t(i)?(r(),g(y,{key:1,width:"24",height:"24"})):p("",!0)]),_:1}),l(se,{name:"fade"},{default:c(()=>[t(i)?(r(),g(X,{key:0,"backtest-history":t(a).activeBot.backtestHistory,"selected-backtest-result-key":t(a).activeBot.selectedBacktestResultKey,"can-use-modify":t(a).activeBot.botApiVersion>=2.32,onSelectionChange:t(a).activeBot.setBacktestResultKey,onRemoveResult:t(a).activeBot.removeBacktestResultFromMemory,onUpdateResult:t(a).activeBot.saveBacktestResultMetadata},null,8,["backtest-history","selected-backtest-result-key","can-use-modify","onSelectionChange","onRemoveResult","onUpdateResult"])):p("",!0)]),_:1})],2)):p("",!0),d("div",ts,[d("div",as,[t(o)==="historicResults"?(r(),b("div",ss,[l(Y)])):p("",!0),t(o)==="run"?(r(),b("div",ns,[l(V)])):p("",!0),t(_)&&t(o)==="results"?(r(),g(D,{key:2,"backtest-result":t(a).activeBot.selectedBacktestResult,class:"flex-fill"},null,8,["backtest-result"])):p("",!0),t(_)&&t(o)==="compare-results"?(r(),g(I,{key:3,"backtest-results":t(a).activeBot.backtestHistory,class:"flex-fill"},null,8,["backtest-results"])):p("",!0),t(_)&&t(o)==="visualize-summary"?(r(),g(z,{key:4,trades:t(a).activeBot.selectedBacktestResult.trades,class:"flex-fill"},null,8,["trades"])):p("",!0)]),t(_)&&t(o)==="visualize"?(r(),b("div",ls,[l(we,{timeframe:t(s),strategy:t(n).strategy,timerange:t(n).timerange,"backtest-result":t(a).activeBot.selectedBacktestResult,"freqai-model":t(n).freqAI.enabled?t(n).freqAI.model:void 0},null,8,["timeframe","strategy","timerange","backtest-result","freqai-model"])])):p("",!0)])])])}}}),$s=O(os,[["__scopeId","data-v-033013dd"]]);export{$s as default};
//# sourceMappingURL=BacktestingView-B8Itz9ss.js.map
